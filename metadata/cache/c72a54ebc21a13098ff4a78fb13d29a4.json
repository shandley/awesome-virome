{
  "cache_date": "2025-03-17T02:29:56.882421",
  "data": "[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/gbouras13/pharokka/blob/master/run_pharokka_and_phold_and_phynteny.ipynb)\n\n[![Paper](https://img.shields.io/badge/paper-Bioinformatics-teal.svg?style=flat-square&maxAge=3600)](https://doi.org/10.1093/bioinformatics/btac776)\n[![CI](https://github.com/gbouras13/pharokka/actions/workflows/ci.yaml/badge.svg)](https://github.com/gbouras13/pharokka/actions/workflows/ci.yaml)\n[![BioConda Install](https://img.shields.io/conda/dn/bioconda/pharokka.svg?style=flag&label=BioConda%20install)](https://anaconda.org/bioconda/pharokka)\n[![codecov](https://codecov.io/gh/gbouras13/pharokka/branch/master/graph/badge.svg?token=4B1T2PGM9V)](https://codecov.io/gh/gbouras13/pharokka)\n\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/pharokka/badges/version.svg)](https://anaconda.org/bioconda/pharokka)\n[![Bioconda Downloads](https://img.shields.io/conda/dn/bioconda/pharokka)](https://img.shields.io/conda/dn/bioconda/pharokka)\n[![PyPI version](https://badge.fury.io/py/pharokka.svg)](https://badge.fury.io/py/pharokka)\n[![Downloads](https://static.pepy.tech/badge/pharokka)](https://pepy.tech/project/pharokka)\n\npharokka\n=================\n\n<p align=\"center\">\n  <img src=\"img/pharokka_logo.png\" alt=\"pharokka Logo\" height=400>\n</p>\n\nExtra special thanks to Ghais Houtak for making Pharokka's logo.\n\n## Fast Phage Annotation Tool\n\n`pharokka` is a rapid standardised annotation tool for bacteriophage genomes and metagenomes.\n\nIf you are looking for rapid standardised annotation of bacterial genomes, please use [Bakta](https://github.com/oschwengers/bakta). [Prokka](https://github.com/tseemann/prokka), which inspired the creation and naming of `pharokka`, is another good option, but Bakta is [Prokka's worthy successor](https://twitter.com/torstenseemann/status/1565471892840259585).\n\n# phold\n\nIf you like `pharokka`, you will probably love [phold](https://github.com/gbouras13/phold). `phold` uses structural homology to improve phage annotation. Benchmarking is ongoing but `phold` strongly outperforms `pharokka` in terms of annotation, particularly for less characterised phages such as those from metagenomic datasets.\n\n`pharokka` still has features `phold` lacks for now (identifying tRNA, tmRNA, CRISPR repeats, and INPHARED taxonomy search), so it is recommended to run `phold` after running `pharokka`. \n\n`phold` takes the Genbank output of Pharokka as input. Therefore, if you have already annotated your phage(s) with Pharokka, you can easily update the annotation with more functional predictions with [phold](https://github.com/gbouras13/phold).\n\n# Google Colab Notebooks\n\nIf you don't want to install `pharokka` or `phold` locally, you can run `pharokka` and `phold` (and [`phynteny`](https://github.com/susiegriggo/Phynteny)), or only `pharokka`, without any code using the [Google Colab notebook](https://colab.research.google.com/github/gbouras13/pharokka/blob/master/run_pharokka_and_phold_and_phynteny.ipynb).\n\n* [`phynteny`](https://github.com/susiegriggo/Phynteny) uses a long-short term memory model trained on phage synteny (the conserved gene order across phages) to assign hypothetical phage proteins to a PHROG category - it might help you add extra PHROG category annotations to hypothetical genes remaining after you run `phold`. \n* Note: Phynteny will work only if your phage has fewer than 120 predicted proteins\n* You can still use this notebook to run `pharokka` and/or `phold` if your phage(s) are too big - just don't run the Phynteny step!\n  \n\n# Table of Contents\n\n- [pharokka](#pharokka)\n  - [Fast Phage Annotation Tool](#fast-phage-annotation-tool)\n- [phold](#phold)\n- [Google Colab Notebooks](#google-colab-notebooks)\n- [Table of Contents](#table-of-contents)\n- [Quick Start](#quick-start)\n- [Documentation](#documentation)\n- [Paper](#paper)\n- [Pharokka with Galaxy Europe Webserver](#pharokka-with-galaxy-europe-webserver)\n- [Brief Overview](#brief-overview)\n  - [Pharokka v 1.7.0 Update](#pharokka-v-170-update)\n  - [Pharokka v 1.6.0 Update (11 January 2024)](#pharokka-v-160-update-11-january-2024)\n  - [Pharokka v 1.5.0 Update (20 September 2023)](#pharokka-v-150-update-20-september-2023)\n  - [Pharokka v 1.4.0 Update (27 August 2023)](#pharokka-v-140-update-27-august-2023)\n  - [Pharokka v 1.3.0 Update](#pharokka-v-130-update)\n- [Installation](#installation)\n  - [Conda Installation](#conda-installation)\n  - [Pip](#pip)\n  - [Container](#container)\n  - [Source](#source)\n- [Database Installation](#database-installation)\n- [Beginner Conda Installation](#beginner-conda-installation)\n- [Beginner Conda Installation](#beginner-conda-installation-1)\n- [Usage](#usage)\n- [Version Log](#version-log)\n- [System](#system)\n- [Time](#time)\n- [Benchmarking v1.5.0](#benchmarking-v150)\n- [Benchmarking v1.4.0](#benchmarking-v140)\n- [Original Benchmarking (v1.1.0)](#original-benchmarking-v110)\n- [Bugs and Suggestions](#bugs-and-suggestions)\n- [Citation](#citation)\n\n# Quick Start\n\nThe easiest way to install `pharokka` is via conda:\n\n`conda install -c bioconda pharokka`\n\nFollowed by database download and installation:\n\n`install_databases.py -o <path/to/databse_dir>`\n\nAnd finally annotation:\n\n`pharokka.py -i <phage fasta file> -o <output directory> -d <path/to/database_dir> -t <threads>`\n\nAs of `pharokka` v1.4.0, if you want extremely rapid PHROG annotations, use `--fast`:\n\n`pharokka.py -i <phage fasta file> -o <output directory> -d <path/to/database_dir> -t <threads> --fast`\n\n# Documentation\n\nCheck out the full documentation at [https://pharokka.readthedocs.io](https://pharokka.readthedocs.io).\n\n# Paper\n\n`pharokka` has been published in *Bioinformatics*:\n\nGeorge Bouras, Roshan Nepal, Ghais Houtak, Alkis James Psaltis, Peter-John Wormald, Sarah Vreugde, Pharokka: a fast scalable bacteriophage annotation tool, Bioinformatics, Volume 39, Issue 1, January 2023, btac776, https://doi.org/10.1093/bioinformatics/btac776.\n\nIf you use `pharokka`, please see the full [Citation](#citation) section for a list of all programs pharokka uses, in order to fully recognise the creators of these tools for their work.\n\n# Pharokka with Galaxy Europe Webserver\n\nThanks to some amazing assistance from [Paul Zierep](https://github.com/paulzierep), you can run `pharokka` using the [Galaxy Europe webserver](https://usegalaxy.eu/?tool_id=toolshed.g2.bx.psu.edu%2Frepos%2Fiuc%2Fpharokka%2Fpharokka%2F1.2.1%2Bgalaxy1&version=1.2.1%20galaxy1). There is no plotting functionality at the moment.\n\nSo if you can't get `pharokka` to install on your machine for whatever reason or want a GUI to annotate your phage(s), please give it a go there.\n\n# Brief Overview\n\n<p align=\"center\">\n  <img src=\"img/pharokka_workflow.png\" alt=\"pharokka Workflow\" height=600>\n</p>\n\n`pharokka` uses [PHANOTATE](https://github.com/deprekate/PHANOTATE), the only gene prediction program tailored to bacteriophages, as the default program for gene prediction. [Prodigal](https://github.com/hyattpd/Prodigal) implemented with [pyrodigal](https://github.com/althonos/pyrodigal) and [Prodigal-gv](https://github.com/apcamargo/prodigal-gv) implemented with [pyrodigal-gv](https://github.com/althonos/pyrodigal-gv) are also available as alternatives. Following this, functional annotations are assigned by matching each predicted coding sequence (CDS) to the [PHROGs](https://phrogs.lmge.uca.fr), [CARD](https://card.mcmaster.ca) and [VFDB](http://www.mgc.ac.cn/VFs/main.htm) databases using [MMseqs2](https://github.com/soedinglab/MMseqs2). As of v1.4.0, `pharokka` will also match each CDS to the PHROGs database using more sensitive Hidden Markov Models using [PyHMMER](https://github.com/althonos/pyhmmer). Pharokka's main output is a GFF file suitable for using in downstream pangenomic pipelines like [Roary](https://sanger-pathogens.github.io/Roary/). `pharokka` also generates a `cds_functions.tsv` file, which includes counts of CDSs, tRNAs, tmRNAs, CRISPRs and functions assigned to CDSs according to the PHROGs database. See the full [usage](#usage) and check out the full [documentation](https://pharokka.readthedocs.io) for more details.  \n\n## Pharokka v 1.7.0 Update\n\nYou can run `pharokka_multiplotter.py` to plot as many phage(s) as you want.\n\nIt requires the `pharokka` output Genbank file (here, `pharokka.gbk`). It will save plots for each contig in the output directory (here `pharokka_plots_output_directory`). \n\ne.g.\n\n```\npharokka_multiplotter.py -g pharokka.gbk  -o pharokka_plots_output_directory \n```\n\n## Pharokka v 1.6.0 Update (11 January 2024)\n\n* Fixes a variety of bugs (#300 `pharokka_proteins.py` crashing if it found VFDB hits, #303 errors in the `.tbl` format, #316 errors with types and where custom HMM dbs had identical scored hits, #317 types and #320 deprecated GC function)\n* Adds `--mash_distance` and `--minced_args` as parameters (#299 thanks @iferres).\n\n## Pharokka v 1.5.0 Update (20 September 2023)\n\n* Adds support for `pyrodigal-gv` implementing `prodigal-gv` as a gene predictor for alternate genetic codes ([pyrodigal-gv](https://github.com/althonos/pyrodigal-gv) and [prodigal-gv](https://github.com/apcamargo/prodigal-gv)). This can be specified with `-g prodigal-gv` and is recommended for metagenomic input datasets. Thanks to @[althonos](https://github.com/althonos) and @[apcamargo](https://github.com/apcamargo) for making this possible, and to @[asierFernandezP](https://github.com/asierFernandezP) for raising this as an issue in the first place [here](https://github.com/gbouras13/pharokka/issues/290).\n* `-g prodigal` and `-g prodigal-gv` should be much faster thanks to multithread support added by the inimitable @[althonos](https://github.com/althonos).\n* Adds checks to determine if your input FASTA has duplicated [contig headers](https://github.com/gbouras13/pharokka/issues/293). Thanks @[thauptfeld](https://github.com/thauptfeld) for raising this.\n* Genbank format output will be designated with PHG not VRL.\n* The `_length_gc_cds_density.tsv` and `_cds_final_merged_output.tsv` files now contain the translation table/genetic code for each contig.\n* `--skip_mash` flag added to skip finding the closest match for each contig in INPHARED using mash.\n* `--skip_extra_annotations` flag added to skip running tRNA-scanSE, MinCED and Aragorn in case you only want CDS predictions and functional annotations.\n\n\n## Pharokka v 1.4.0 Update (27 August 2023)\n\n`pharokka` v1.4.0 is a large update implementing:\n\n* More sensitive search for PHROGs using Hidden Markov Models (HMMs) using the amazing [PyHMMER](https://github.com/althonos/pyhmmer).\n* By default, `pharokka` will now run searches using both MMseqs2 (PHROGs, CARD and VFDB) and HMMs (PHROGs). MMseqs2 was kept for PHROGs as it provides more information than the HMM results (e.g. sequence alignment identities & top hit PHROG protein) if it finds a hit. \n* `--fast` or `--hmm_only` which only runs PyHMMER on PHROGs. It will not run MMseqs2 at all on PHROGs, CARD or VFDB. For phage isolates, this will be much faster than v1.3.2, but you will not get CARD or VFDB annotations. For metagenomes, this will be (much) slower though!\n* Other changes in the codebase should make `pharokka` v1.4.0 run somewhat faster than v1.3.2, even if PyHMMER is not used and `--mmseqs2_only` is specified.\n* Updated databases as of 23 August 2023. You will need to download the new `pharokka` v1.4.0 databases. The VFDB database is now clustered at 50% sequence identity (which speeds up runtime).\n* `--mmseqs2_only` which will essentially run `pharokka` v1.3.2 and is default in meta mode `-m` or `--meta`. \n* `pharokka_proteins.py`, which takes an input file of amino acid proteins in FASTA format and runs MMseqs2 (PHROGs, CARD, VFDB) and PyHMMER (PHROGs). See the [proteins documentation](docs/proteins.md) for more details.\n* `--custom_hmm`, which allows for custom HMM profile databases to be used with `pharokka`.\n* `create_custom_hmm.py` which facilitates  the creation of a HMM profile database from multiple sequence alignments.  See the [documentation](docs/custom.md) for more details about how to create a compatible HMM profile database.\n* `--dnaapler`, which automatically detects and reorients your phage to start with the large terminase subunit. For more information, see [dnaapler](https://github.com/gbouras13/dnaapler).\n* `--genbank`, which allows for genbank format input with `-i`. This will take all (custom) CDS calls in genbank file and PHANOTATE/pyrodigal will not be run. So if you have done manual gene curation, this option is recommended.\n* Fixes to `-c`, which should now work with `-g prodigal` (thanks Alistair Legione for the fixes).\n\n## Pharokka v 1.3.0 Update\n\n`pharokka` v1.3.0 implements `pharokka_plotter.py`, which creates a simple circular genome plot using the amazing [pyCirclize](https://github.com/moshi4/pyCirclize) package with output in PNG format. All CDS are coloured according to their PHROG functional group. \n\nIt is reasonably customisable and is designed for single input phage contigs. If an input FASTA with multiple contigs is entered, it will only plot the first contig. \n\nIt requires the input FASTA, `pharokka` output directory, and the `-p` or `--prefix` value used with `pharokka` if specified. \n\nYou can run `pharokka_plotter.py` in the following form\n\n```\npharokka_plotter.py -i input.fasta -n pharokka_plot -o pharokka_output_directory \n```\n\nThis will create `pharokka_plot.png` as an output file plot of your phage.\n\nAn example plot is included below made with the following command (assuming Pharokka has been run with `SAOMS1_pharokka_output_directory` as the output directory).\n\n``` \npharokka_plotter.py -i test_data/SAOMS1.fasta -n SAOMS1_plot -o SAOMS1_pharokka_output_directory --interval 8000 --annotations 0.5 --plot_title '${Staphylococcus}$ Phage SAOMS1'\n```\n\n<p align=\"center\">\n  <img src=\"img/SAOMS1_plot.png\" alt=\"SAOMS1 example\" height=600>\n</p>\n\nSAOMS1 phage (GenBank: MW460250.1) was isolated and sequenced by: Yerushalmy, O., Alkalay-Oren, S., Coppenhagen-Glazer, S. and Hazan, R. from the Institute of Dental Sciences and School of Dental Medicine, Hebrew University, Israel.\n\nPlease see [plotting](docs/plotting.md) for details on all plotting parameter options. \n\n# Installation\n\n## Conda Installation \n\nThe easiest way to install `pharokka` is via conda. For inexperienced command line users, this method is highly recommended.\n\n`conda install -c bioconda pharokka`\n\nThis will install all the dependencies along with `pharokka`. The dependencies are listed in environment.yml.\n\nIf conda is taking a long time to solve the environment, try using mamba:\n\n```\nconda install mamba\nmamba install -c bioconda pharokka\n```\n\n## Pip\n\nAs of v1.4.0, you can also install the python components of `pharokka` with pip.\n\n```\npip install pharokka\n```\n\nYou will still need to install the non-python dependencies manually.\n\n## Container\n\nIf you have Docker/Singularity/Apptainer installed, you can use the [biocontainers container](https://quay.io/repository/biocontainers/pharokka?tab=tags) (yes, every bioconda package has one!)\n\nYou might find this useful if you have trouble with conda environments.\n\nFor example to install `pharokka v1.7.3` with Singularity:\n\n```\nIMAGE_DIR=\"<the directory you want the .sif file to be in >\"\n# e.g. to pull into the working directory\nIMAGE_DIR=$PWD\nsingularity pull --dir $IMAGE_DIR docker://quay.io/biocontainers/pharokka:1.7.3--pyhdfd78af_0\n```\n\n* Then to run, you use the same commands but prepended with `singularity exec <.sif file>` e.g.:\n\n```\ncontainerImage=\"$IMAGE_DIR/pharokka_1.7.3--pyhdfd78af_0.sif\"\nsingularity exec $containerImage pharokka.py -h\n```\n\n\n## Source\n\nAlternatively, the development version of `pharokka` (which may include new, untested features) can be installed manually via github. \n\n```\ngit clone https://github.com/gbouras13/pharokka.git\ncd pharokka\npip install -e .\npharokka.py --help\n```\n\nThe dependencies found in environment.yml will then need to be installed manually.\n\nFor example using conda to install the required dependencies:\n\n```\nconda env create -f environment.yml\nconda activate pharokka_env\n# assuming you are in the pharokka directory \n# installs pharokka from source\npip install -e .\npharokka.py --help\n```\n\n# Database Installation\n\nTo install the `pharokka` database to the default directory:\n\n`install_databases.py -d`\n\nIf you would like to specify a different database directory (recommended), that can be achieved as follows:\n\n`install_databases.py -o <path/to/databse_dir>`\n\nIf this does not work, you an alternatively download the databases from Zenodo at https://zenodo.org/record/8276347/files/pharokka_v1.4.0_databases.tar.gz and untar the directory in a location of your choice.\n\nIf you prefer to use the command line:\n\n```\nwget \"https://zenodo.org/record/8276347/files/pharokka_v1.4.0_databases.tar.gz\"\ntar -xzf pharokka_v1.4.0_databases.tar.gz\n```\n\nwhich will create a directory called \"pharokka_v1.4.0_databases\" containing the databases.\n\n# Beginner Conda Installation\n\nIf you are new to using the command-line, please install conda using the following instructions.\n\n\n# Beginner Conda Installation\n\nIf you are new to using the command-line, please install conda using the following instructions.\n\n1. Install Conda - I would recommend [miniforge](https://github.com/conda-forge/miniforge).\n2. Assuming you are using a Linux x86_64 machine (for other architectures, please replace the URL with the appropriate one on the [miniforge](https://github.com/conda-forge/miniforge) repository).\n\n`wget https://github.com/conda-forge/miniforge/releases/download/24.9.2-0/Miniforge3-24.9.2-0-Linux-x86_64.sh`\n\nFor Mac Intel:\n\n`wget https://github.com/conda-forge/miniforge/releases/download/24.9.2-0/Miniforge3-24.9.2-0-MacOSX-x86_64.sh`\n\nFor Mac M1/M2/M3/M4\n\n`wget https://github.com/conda-forge/miniforge/releases/download/24.9.2-0/Miniforge3-24.9.2-0-MacOSX-arm64.sh`\n\n3. Install miniforge and follow the prompts.\n\n`sh Miniforge3-24.9.2-0-Linux-x86_64.sh`\n\n4. After installation is complete, you should add the following channels to your conda configuration:\n\n```bash\nconda config --add channels defaults\nconda config --add channels bioconda\nconda config --add channels conda-forge\n```\n\n 5. Finally, I would recommend installing pharokka into a fresh environment. For example to create an environment called pharokkaENV with pharokka installed:\n\n```bash\nconda create -n pharokkaENV pharokka\nconda activate pharokkaENV\ninstall_databases.py -h\npharokka.py -h\n```\n\nIf you have a Mac with Apple Silicon (M1-M4), try\n\n```bash\nconda create --platform osx-64 -n pharokkaENV pharokka\nconda activate pharokkaENV\ninstall_databases.py -h\npharokka.py -h\n```\n\n# Usage\n\nOnce the databases have finished downloading, to run `pharokka`:\n\n`pharokka.py -i <fasta file> -o <output directory> -t <threads>`\n\nTo specify a different database directory (recommended):\n\n`pharokka.py -i <fasta file> -o <output directory> -d <path/to/database_dir> -t <threads> -p <prefix>`\n\nFor a full explanation of all arguments, please see [usage](docs/run.md).\n\npharokka defaults to 1 thread.\n\n```\nusage: pharokka.py [-h] [-i INFILE] [-o OUTDIR] [-d DATABASE] [-t THREADS] [-f] [-p PREFIX] [-l LOCUSTAG] [-g GENE_PREDICTOR] [-m] [-s]\n                   [-c CODING_TABLE] [-e EVALUE] [--fast] [--mmseqs2_only] [--meta_hmm] [--dnaapler] [--custom_hmm CUSTOM_HMM] [--genbank]\n                   [--terminase] [--terminase_strand TERMINASE_STRAND] [--terminase_start TERMINASE_START] [--skip_extra_annotations]\n                   [--skip_mash] [--minced_args MINCED_ARGS] [--mash_distance MASH_DISTANCE] [-V] [--citation]\n\npharokka: fast phage annotation program\n\noptions:\n  -h, --help            show this help message and exit\n  -i INFILE, --infile INFILE\n                        Input genome file in fasta format.\n  -o OUTDIR, --outdir OUTDIR\n                        Directory to write the output to.\n  -d DATABASE, --database DATABASE\n                        Database directory. If the databases have been installed in the default directory, this is not required. Otherwise specify the path.\n  -t THREADS, --threads THREADS\n                        Number of threads. Defaults to 1.\n  -f, --force           Overwrites the output directory.\n  -p PREFIX, --prefix PREFIX\n                        Prefix for output files. This is not required.\n  -l LOCUSTAG, --locustag LOCUSTAG\n                        User specified locus tag for the gff/gbk files. This is not required. A random locus tag will be generated instead.\n  -g GENE_PREDICTOR, --gene_predictor GENE_PREDICTOR\n                        User specified gene predictor. Use \"-g phanotate\" or \"-g prodigal\" or \"-g prodigal-gv\" or \"-g genbank\". \n                        Defaults to phanotate (not required unless prodigal is desired).\n  -m, --meta            meta mode for metavirome input samples\n  -s, --split           split mode for metavirome samples. -m must also be specified. \n                        Will output separate split FASTA, gff and genbank files for each input contig.\n  -c CODING_TABLE, --coding_table CODING_TABLE\n                        translation table for prodigal. Defaults to 11.\n  -e EVALUE, --evalue EVALUE\n                        E-value threshold for MMseqs2 database PHROGs, VFDB and CARD and PyHMMER PHROGs database search. Defaults to 1E-05.\n  --fast, --hmm_only    Runs PyHMMER (HMMs) with PHROGs only, not MMseqs2 with PHROGs, CARD or VFDB. \n                        Designed for phage isolates, will not likely be faster for large metagenomes.\n  --mmseqs2_only        Runs MMseqs2 with PHROGs, CARD and VFDB only (same as Pharokka v1.3.2 and prior). Default in meta mode.\n  --meta_hmm            Overrides --mmseqs2_only in meta mode. Will run both MMseqs2 and PyHMMER.\n  --dnaapler            Runs dnaapler to automatically re-orient all contigs to begin with terminase large subunit if found. \n                        Recommended over using '--terminase'.\n  --custom_hmm CUSTOM_HMM\n                        Run pharokka with a custom HMM profile database suffixed .h3m. \n                        Please use create this with the create_custom_hmm.py script.\n  --genbank             Flag denoting that -i/--input is a genbank file instead of the usual FASTA file. \n                         The CDS calls in this file will be preserved and re-annotated.\n  --terminase           Runs terminase large subunit re-orientation mode. \n                        Single genome input only and requires --terminase_strand and --terminase_start to be specified.\n  --terminase_strand TERMINASE_STRAND\n                        Strand of terminase large subunit. Must be \"pos\" or \"neg\".\n  --terminase_start TERMINASE_START\n                        Start coordinate of the terminase large subunit.\n  --skip_extra_annotations\n                        Skips tRNAscan-se, MINced and Aragorn.\n  --skip_mash           Skips running mash to find the closest match for each contig in INPHARED.\n  --minced_args MINCED_ARGS\n                        extra commands to pass to MINced (please omit the leading hyphen for the first argument). You will need to use quotation marks e.g. --minced_args \"minNR 2 -minRL 21\"\n  --mash_distance MASH_DISTANCE\n                        mash distance for the search against INPHARED. Defaults to 0.2.\n  --trna_scan_model {general,bacterial}\n                        tRNAscan-SE model\n  -V, --version         Print pharokka Version\n  --citation            Print pharokka Citation\n  ```\n\n# Version Log\n\nA brief description of what is new in each update of `pharokka` can be found in the HISTORY.md file.\n\n# System\n\n`pharokka` has been tested on Linux and MacOS (M1 and Intel).\n\n# Time\n\nOn a standard 16GB RAM laptop specifying 8 threads, `pharokka` should take between 3-10 minutes to run for a single phage, depending on the genome size. \n\nIn `--fast` mode, it should take 45-75 seconds.\n\n# Benchmarking v1.5.0 \n\n`pharokka v1.5.0` was run on the 673 crAss phage dataset to showcase the improved CDS prediction of `-g prodigal-gv` for metagenomic datasets where some phages likely have alternative genetic codes (i.e. not 11). \n\nAll benchmarking was conducted on a Intel\u00ae Core\u2122 i7-10700K CPU @ 3.80GHz on a machine running Ubuntu 20.04.6 LTS with 8 threads (`-t 8`). `pyrodigal-gv v0.1.0` and `pyrodigal v3.0.0` were used respectively. \n\n| 673 crAss-like genomes | `pharokka` v1.5.0 `-g prodigal-gv` | `pharokka` v1.5.0 `-g prodigal` | \n|------------------------|------------------------------------|----------------------------------|\n| Total CDS              | **81730**                          | 91999                            | \n| Annotated Function CDS | **20344**                          | 17458                            | \n| Unknown Function CDS   | 61386                              | 74541                            |\n| Contigs with genetic code 15 | 229                          | NA                               | \n| Contigs with genetic code 4 | 38                            | NA                               | \n| Contigs with genetic code 11 | 406                          | 673                              | \n\nFewer (larger) CDS were predicted more accurately, leading to an increase in the number of coding sequences with annotated functions. Approximately 40% of contigs in this dataset were predicted to use non-standard genetic codes according to `pyrodigal-gv`.\n\n# Benchmarking v1.4.0 \n\n`pharokka` v1.4.0 has also been run on phage SAOMS1 and also the same 673 crAss phage dataset to showcase:\n\n1. The improved sensitivity of gene annotation with PyHMMER and a demonstration of how `--fast` is slower for metagenomes. \n    * If you can deal with the compute cost (especially for large metagenomes), I highly recommend `--fast` or  `--meta_hmm` for metagenomes given how much more sensitive HMM search is.\n2. The large speed-up over v1.3.2 with `--fast` for phage isolates - with the proviso that no virulence factors or AMR genes will be detected. \n3. The slight speed-up over v1.3.2 with `--mmseqs2_only`.\n\nAll benchmarking was conducted on a Intel\u00ae Core\u2122 i7-10700K CPU @ 3.80GHz on a machine running Ubuntu 20.04.6 LTS with 16 threads (`-t 16`). \n\nSAOMS1 was run with Phanotate\n\n| Phage SAOMS1           | `pharokka` v1.4.0 `--fast`  | `pharokka` v1.4.0 | `pharokka` v1.3.2 |   \n|------------------------|-----------------------------|-------------------|-----------------|\n| Time (min)             | 0.70                        | 3.73              | 5.08            | \n| CDS                    | 246                         | 246               | 246             | \n| Annotated Function CDS | 93                          | 93                | 92              | \n| Unknown Function CDS   | 153                         | 153               | 154             |  \n\nThe 673 crAss-like genomes were run with `-m` (defaults to `--mmseqs2_only` in v 1.4.0) and with `-g prodigal` (pyrodigal v2.1.0).\n\n| 673 crAss-like genomes | `pharokka` v1.4.0 `--fast`  | `pharokka` v1.4.0 `--mmseqs2_only` | `pharokka` v1.3.2 |\n|------------------------|---------------------------|----------------------------------|-----------------|\n| Time (min)             | 35.62                     | 11.05                            | 13.27           |\n| CDS                    | 91999                     | 91999                            | 91999           |\n| Annotated Function CDS | **16713**                 | 9150                             | 9150            |\n| Unknown Function CDS   | 75286                     | 82849                            | 82849           |\n\n\n# Original Benchmarking (v1.1.0)\n\n`pharokka` (v1.1.0) has been benchmarked on an Intel Xeon CPU E5-4610 v2 @ 2.30 specifying 16 threads. Below is benchamarking comparing `pharokka` run with PHANOTATE and Prodigal against Prokka v1.14.6 run with PHROGs HMM profiles, as modified by Andrew Millard (https://millardlab.org/2021/11/21/phage-annotation-with-phrogs/).\n\nBenchmarking was conducted on Enterbacteria Phage Lambda (Genbank accession J02459) Staphylococcus Phage SAOMS1 (Genbank Accession MW460250) and 673 crAss-like phage genomes in one multiFASTA input taken from Yutin, N., Benler, S., Shmakov, S.A. et al. Analysis of metagenome-assembled viral genomes from the human gut reveals diverse putative CrAss-like phages with unique genomic features. Nat Commun 12, 1044 (2021) https://doi.org/10.1038/s41467-021-21350-w.\n\n\nFor the crAss-like phage genomes, `pharokka` meta mode `-m` was enabled.\n\n| Phage Lambda            | `pharokka` PHANOTATE | `pharokka` Prodigal | Prokka with PHROGs | \n|------------------------|--------------------|-------------------|--------------------|\n| Time (min)             | 4.19               | 3.88              | 0.27               |\n| CDS                    | 88                 | 61                | 62                 | \n| Coding Density (%)     | 94.55              | 83.69             | 84.96              | \n| Annotated Function CDS | 43                 | 37                | 45                 |  \n| Unknown Function CDS   | 45                 | 24                | 17                 | \n\n| Phage SAOMS1           | `pharokka` PHANOTATE | `pharokka` Prodigal | Prokka with PHROGs |   \n|------------------------|--------------------|-------------------|--------------------|\n| Time (min)             | 4.26               | 3.89              | 0.93               | \n| CDS                    | 246                | 212               | 212                | \n| Coding Density (%)     | 92.27              | 89.69             | 89.31              |  \n| Annotated Function CDS | 92                 | 93                | 92                 | \n| Unknown Function CDS   | 154                | 119               | 120                |  \n\n| 673 crAss-like genomes from Yutin et al., 2021 | `pharokka` PHANOTATE Meta Mode | `pharokka` Prodigal Meta Mode  | Prokka with PHROGs |\n|------------------------------------------------|------------------------------|------------------------------|--------------------|\n| Time (min)                                     | 106.55                       | 11.88                        | 252.33             |\n| Time Gene Prediction (min)                     | 96.21                        | 3.4                          | 5.12               |\n| Time tRNA Prediction (min)                     | 1.25                         | 1.08                         | 0.3                |\n| Time Database Searches (min)                   | 6.75                         | 5.58                         | 238.77             |\n| CDS                                            | 138628                       | 90497                        | 89802              |\n| Contig Min Coding Density (%)                  | 66.01                        | 46.18                        | 46.13              |\n| Contig Max Coding Density (%)                  | 98.86                        | 97.85                        | 97.07              |\n| Annotated Function CDS                         | 9341                         | 9228                         | 14461              |\n| Unknown Function CDS                           | 129287                       | 81269                        | 75341              |\n\n`pharokka` scales well for large metavirome datasets due to the speed of MMseqs2. In fact, as the size of the input file increases, the extra time taken is required for running gene prediction (particularly PHANOTATE) and tRNA-scan SE2 - the time taken to conduct MMseqs2 searches remain small due to its many vs many approach. \n\nIf you require  fast annotations of extremely large datasets (i.e. thousands of input contigs), running `pharokka` with Prodigal (`-g prodigal`) is recommended.\n\n \n# Bugs and Suggestions\n\nIf you come across bugs with `pharokka`, or would like to make any suggestions to improve the program, please open an issue or email george.bouras@adelaide.edu.au.\n\n# Citation\n\nGeorge Bouras, Roshan Nepal, Ghais Houtak, Alkis James Psaltis, Peter-John Wormald, Sarah Vreugde, Pharokka: a fast scalable bacteriophage annotation tool, Bioinformatics, Volume 39, Issue 1, January 2023, btac776, https://doi.org/10.1093/bioinformatics/btac776\n\nIf you use `pharokka`, I would recommend a citation in your manuscript along the lines of:\n\n* All phages were annotated with Pharokka v ___ (Bouras, et al. 2023). Specifically, coding sequences (CDS) were predicted with PHANOTATE (McNair, et al. 2019), tRNAs were predicted with tRNAscan-SE 2.0 (Chan, et al. 2021), tmRNAs were predicted with Aragorn (Laslett, et al. 2004) and CRISPRs were preducted with CRT (Bland, et al. 2007). Functional annotation was generated by matching each CDS to the PHROGs (Terzian, et al. 2021), VFDB (Chen, et al. 2005) and CARD (Alcock, et al. 2020) databases using MMseqs2 (Steinegger, et al. 2017) and PyHMMER (Larralde, et al. 2023). Contigs were matched to their closest hit in the INPHARED database (Cook, et al. 2021) using mash (Ondov, et al. 2016). Plots were created with pyCirclize (Shimoyama 2022).\n\nWith the following full citations for the constituent tools below where relevant:\n\n* Cook R, Brown N, Redgwell T, Rihtman B, Barnes M, Clokie M, Stekel DJ, Hobman JL, Jones MA, Millard A. INfrastructure for a PHAge REference Database: Identification of Large-Scale Biases in the Current Collection of Cultured Phage Genomes. PHAGE. 2021. Available from: http://doi.org/10.1089/phage.2021.0007.\n* McNair K., Zhou C., Dinsdale E.A., Souza B., Edwards R.A. (2019) \"PHANOTATE: a novel approach to gene identification in phage genomes\", Bioinformatics, https://doi.org/10.1093/bioinformatics/btz26.\n* Chan, P.P., Lin, B.Y., Mak, A.J. and Lowe, T.M. (2021) \"tRNAscan-SE 2.0: improved detection and functional classification of transfer RNA genes\", Nucleic Acids Res., https://doi.org/10.1093/nar/gkab688.\n* Steinegger M. and Soeding J. (2017), \"MMseqs2 enables sensitive protein sequence searching for the analysis of massive data sets\", Nature Biotechnology https://doi.org/10.1038/nbt.3988.\n* Ondov, B.D., Treangen, T.J., Melsted, P. et al. Mash: fast genome and metagenome distance estimation using MinHash. Genome Biol 17, 132 (2016). https://doi.org/10.1186/s13059-016-0997-x.\n* Terzian P., Olo Ndela E., Galiez C., Lossouarn J., P\u00e9rez Bucio R.E., Mom R., Toussaint A., Petit M.A., Enault F., \"PHROG : families of prokaryotic virus proteins clustered using remote homology\", NAR Genomics and Bioinformatics, (2021), https://doi.org/10.1093/nargab/lqab067.\n* Bland C., Ramsey L., Sabree F., Lowe M., Brown K., Kyrpides N.C., Hugenholtz P. , \"CRISPR Recognition Tool (CRT): a tool for automatic detection of clustered regularly interspaced palindromic repeats\", BMC Bioinformatics, (2007), https://doi.org/10.1186/1471-2105-8-209.\n* Laslett D., Canback B., \"ARAGORN, a program to detect tRNA genes and tmRNA genes in nucleotide sequences.\", Nucleic Acids Research (2004) https://doi.org/10.1093/nar/gkh152.\n* Chen L., Yang J., Yao Z., Sun L., Shen Y., Jin Q., \"VFDB: a reference database for bacterial virulence factors\", Nucleic Acids Research (2005) https://doi.org/10.1093/nar/gki008.\n* Alcock et al, \"CARD 2020: antibiotic resistome surveillance with the comprehensive antibiotic resistance database.\" Nucleic Acids Research (2020) https://doi.org/10.1093/nar/gkz935.\n* Larralde, M., (2022). Pyrodigal: Python bindings and interface to Prodigal, an efficient method for gene prediction in prokaryotes. Journal of Open Source Software, 7(72), 4296. doi:10.21105/joss.04296.\n* Larralde M., Zeller G., (2023). PyHMMER: a Python library binding to HMMER for efficient sequence analysis, Bioinformatics, Volume 39, Issue 5, May 2023, btad214, https://doi.org/10.1093/bioinformatics/btad214.\n* Larralde M. and Camargo A., (2023) Pyrodigal-gv: A Pyrodigal extension to predict genes in giant viruses and viruses with alternative genetic code. https://github.com/althonos/pyrodigal-gv.\n* Shimoyama, Y. (2022). pyCirclize: Circular visualization in Python [Computer software]. https://github.com/moshi4/pyCirclize.\n"
}