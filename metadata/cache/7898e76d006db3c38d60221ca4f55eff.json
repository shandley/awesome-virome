{
  "cache_date": "2025-03-17T02:16:51.045307",
  "data": "# Cenote-Taker3\n\n[![install with bioconda](https://img.shields.io/badge/install%20with-bioconda-brightgreen.svg?style=flat)](http://bioconda.github.io/recipes/cenote-taker3/README.html)\n[![Anaconda-Server Badge](https://anaconda.org/bioconda/cenote-taker3/badges/downloads.svg)](https://anaconda.org/bioconda/cenote-taker3)\n\nDiscover and annotate the virome.\n\n![Logo](images/cenote-taker_3_logo.png)\n\nWorks on your laptop or HPC (compatible with MacOS and Linux)\n\n`Cenote-Taker 3` is a virus bioinformatics tool that scales from individual genomes sequences to massive metagenome assemblies to:\n\n1)  Identify sequences containing genes specific to viruses (virus hallmark genes)\n\n2)  Annotate virus sequences including:\n\n---a) adaptive ORF calling\n\n---b) a large catalog of HMMs from virus gene families for functional annotation\n\n---c) Hierarchical taxonomy assignment based on hallmark genes\n\n---d) mmseqs2-based CDD database search\n\n---e) tabular (.tsv) and interactive genome map (.gbf) outputs\n\n**Also, `Cenote-Taker 3` is very fast, many many times faster than `Cenote-Taker 2` for large datasets, and faster than comparable annotation using `pharokka` with more function annotation for virus genes (in my hands)**\n\nImage of example genome map:\n\n<img src='images/genome_map1.png' width='250'>\n\n### Use Cases\n\n1) Discovering virus contigs in metagenomic data\n\n2) Annotating virus sequences without highly similar well-annotated reference\n\n3) Finding prophages (or proviruses) in microbial genomes\n\n### Not-Use Cases\n\n1) Not for read-level classification of known viruses (see [Marker-MAGu](https://github.com/cmmr/Marker-MAGu) or [EsViritu](https://github.com/cmmr/EsViritu) for this task)\n\n2) Not ideal for annotating virus genomes that are highly similar to known references (e.g. phage lambda with a few mutations).\n\n## Schematic\n\n![Schematic](images/cenote-taker_3_schematic.png)\n\n## Installation Instructions\n\n**Most recent versions**\n\nCenote-Taker 3 scripts:   `v3.3.2`\nCenote-Taker 3 Databases: `v3.1.1`\n\n**This should work on MacOS and Linux**\n\n*Versions used in test installations*\n\n`mamba 1.5.8`\n\n`conda 24.7.1`\n\n### Bioconda package (most users)\n\n`mamba` is better/faster than `conda` for almost all solving/installation tasks\n\n1) Use `mamba` to install the bioconda package\n\n**macOS** (specify `osx-64` platform regardless of which chip you have)\n\n`mamba create --platform osx-64 -n ct3_env -c conda-forge -c bioconda cenote-taker3=3.3.2`\n\n**linux**\n\n`mamba create -n ct3_env -c conda-forge -c bioconda cenote-taker3=3.3.2`\n\n<details>\n\n  <summary>Using conda instead</summary>\n\n  **macOS** (specify `osx-64` platform regardless of which chip you have)\n\n  `conda create --platform osx-64 -n ct3_env -c conda-forge -c bioconda cenote-taker3=3.3.2`\n\n  **linux**\n\n  `conda create -n ct3_env -c conda-forge -c bioconda cenote-taker3=3.3.2`\n\n</details>\n\n\n\n2)  Activate the conda environment.\n\n`conda activate ct3_env`\n\n\n*You should be able to type `cenotetaker3` and `get_ct3_dbs` in terminal to bring up help menu now*\n\n3)  Change to a directory where you'd like to install databases and run database script, specify DB directory with `-o`.\n\n*Total DB file size of 3.0 GB after file decompression*\n\n`cd ..`\n\n`get_ct3_dbs -o ct3_DBs --hmm T --hallmark_tax T --refseq_tax  T --mmseqs_cdd T --domain_list T`\n\n<details>\n\n  <summary>With optional hhsuite databases</summary>\n  \n  Warning: due to inconsistent server speed, these downloads may take over 2 hours.\n  \n  You may download one or more hhsuite DB.\n  \n  The data footprint is:\n  \n  | Database | Size   |\n  |----------|--------|\n  | CDD      | 6.1 GB |\n  | pfam     | 4.6 GB |\n  | pdb70    | 56 GB  |\n  \n  ```         \n  get_ct3_dbs -o ct3_DBs --hmm T --hallmark_tax T --refseq_tax T --mmseqs_cdd T --domain_list T --hhCDD T --hhPFAM T --hhPDB T\n  ```\n\n</details>\n\n4)  Set the database directory as a conda environmental variable.\n\n`conda env config vars set CENOTE_DBS=/path/to/ct3_DBs`\n\n### From source (development versions)\n\n1)  Clone this GitHub repo\n\n2)  Using `mamba` (package manager within `conda`) and the provided yaml file, make the environment:\n\n`mamba env create -f Cenote-Taker3/environment/ct3_env.yaml`\n\n3)  Activate the conda environment.\n\n`conda activate ct3_env`\n\n4)  Change to repo and `pip` install command line tool.\n\n`cd Cenote-Taker3`\n\n`pip install .`\n\n*You should be able to type `cenotetaker3` and `get_ct3_dbs` in terminal to bring up help menu now*\n\n5)  Change to a directory where you'd like to install databases and run database script, specify DB directory with `-o`.\n\n*Total DB file size of 3.0 GB after file decompression*\n\n`cd ..`\n\n`get_ct3_dbs -o ct3_DBs --hmm T --hallmark_tax T --refseq_tax T --mmseqs_cdd T --domain_list T`\n\n<details>\n\n  <summary>With optional hhsuite databases</summary>\n  \n  Warning: due to inconsistent server speed, these downloads may take over 2 hours.\n  \n  You may download one or more hhsuite DB.\n  \n  The data footprint is:\n  \n  | Database | Size   |\n  |----------|--------|\n  | CDD      | 6.1 GB |\n  | pfam     | 4.6 GB |\n  | pdb70    | 56 GB  |\n  \n  ```         \n  get_ct3_dbs -o ct3_DBs --hmm T --hallmark_tax T --refseq_tax T --mmseqs_cdd T --domain_list T --hhCDD T --hhPFAM T --hhPDB T\n  ```\n\n</details>\n\n6)  Set the database directory as a conda environmental variable.\n\n`conda env config vars set CENOTE_DBS=/path/to/ct3_DBs`\n\n## Running Cenote-Taker 3\n\n*Make sure conda environment is activated*\n\n### Help Menu\n\n```         \ncenotetaker3 -h\n```\n\n### Test contigs\n\n```         \ncenotetaker3 -c Cenote-Taker3/test_data/testcontigs_DNA_ct2.fasta -r test_ct3 -p T\n```\n\n### Default Discover and Annotate\n\n```         \ncenotetaker3 -c my_metagenome_contigs.fna -r my_meta_ct3 -p T\n```\n\n### Recommended settings for microbial genomes\n\n```         \ncenotetaker3 -c my_metagenome_contigs.fna -r my_meta_ct3 -p T --lin_minimum_hallmark_genes 2\n```\n\n### Discover and Annotate, Force `prodigal` (`prodigal-gv` is default)\n\n```         \ncenotetaker3 -c my_metagenome_contigs.fna -r my_meta_ct3pr -p T --caller prodigal\n```\n\n### Just Annotate\n\n```         \ncenotetaker3 -c my_virus_contigs.fna -r my_virs_ct3 -p F -am T\n```\n\n### Choose which HMM DBs are hallmark (virion rdrp is default)\n\n```         \ncenotetaker3 -c my_metagenome_contigs.fna -r my_meta_ct3 -p T -db virion rdrp dnarep\n```\n\n### Calculate coverage level with reads\n\n```         \ncenotetaker3 -c my_metagenome_contigs.fna -r my_meta_ct3 -p T --reads my_reads/*fastq\n```\n\n## Output Files\n\n<pre>\n{run_title}/\n|   {run_title}_virus_summary.tsv                 <b><- main summary file for each virus</b>\n|   {run_title}_virus_sequences.fna               <b><- all virus genome seqs</b>\n|   {run_title}_virus_AA.faa                      <b><- all virus AA seqs</b>\n|   {run_title}_prune_summary.tsv                 <b><- summary of pruning of each sequence</b>\n|   final_genes_to_contigs_annotation_summary.tsv <b><- annotation info, all genes</b>\n|   run_arguments.txt                             <b><- arguments used in this run</b>\n\u2502   {run_title}_cenotetaker.log                   <b><- main log file</b>\n\u2502\n\u2514\u2500\u2500\u2500sequin_and_genome_maps/\n\u2502   \u2502   {run_title}*gbf                           <b><- genome maps</b>\n\u2502   \u2502   {run_title}*fsa                           <b><- genome sequence</b>\n\u2502   \u2502   {run_title}*gtf                           <b><- feature table gtf format</b>\n\u2502   \u2502   {run_title}*tbl                           <b><- feature table sequin format</b>\n\u2502   \u2502   {run_title}*sqn                           <b><- non-human-readable sequin file for GenBank sub</b>\n\u2502   \u2502   {run_title}*cmt                           <b><- sequin comment file</b>\n\u2502\n\u2514\u2500\u2500\u2500ct_processing/\n    \u2502   <b>--- many intermediate files ---</b>\n</pre>\n\n\n### Ideas for downstream analyses\n\n[CheckV](https://github.com/cmmr/Marker-MAGu) for virus genome completeness estimation.\n\n[BACPHLIP](https://github.com/adamhockenberry/bacphlip) for phage lifestyle prediction (only use complete/near-complete phage genomes).\n\n[VContact3](https://bitbucket.org/MAVERICLab/vcontact3/src/master/) for genome clustering and taxonomy.\n\n[iPHoP](https://bitbucket.org/srouxjgi/iphop/src/main/) for prokaryotic virus host prediction.\n\n### Notes\n\n`Cenote-Taker 3` is under active development, so please open an issue if anything seems unusual or any errors occur. It's likely that I've not tested every parameter combination, and bugs will be a simple fix.\n\n### To-do list\n\n-   instructions for manual curation -\\> GenBank deposit of `Cenote-Taker 3` output\n"
}