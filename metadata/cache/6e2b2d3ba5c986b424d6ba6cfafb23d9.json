{
  "cache_date": "2025-11-01T10:28:11.416620",
  "data": "# Prokaryotic virus Host Predictor (PHP)\n**Prokaryotic virus Host Predictor (PHP)** is a computational tool for host prediction of prokaryotic viruses based on **Gaussian Model (GM)**. \nPHP takes the complete or partial genomic sequences of prokaryotic viruses as inputs. For each virus sequence, \nPHP automatically calculates the probability of host for 60,105 prokaryotic genomes, \nand takes the prokaryotic genome with the largest probability as the predicted host. \nPHP would output the name of prokaryotic genome with the largest score, and output the host score of all prokaryotic genomes. <br>  \nPython packages `pandas`,`numpy`,`sklearn` are needed to be installed before Installation of phageHostPredictor. The program needs to run on the Linux operating system<br>  \n\nDependencies:\n===========\n### Python 3, numpy, pandas, scikit-learn\n\n    pip install pandas\n    pip install numpy\n    pip install -U scikit-learn\n\n\nUsage:\n===========\n\n## Step 1: calculate the *K*-mer frequency of the host\n\n    python3 countKmer.py --fastaFileDir  ./exampleHostGenome --kmerFileDir ./exampleOutput --kmerName HostKmer  --coreNum -1\n\nOr use the simplify command\n\n    python3 countKmer.py -f ./exampleHostGenome -d ./exampleOutput -n HostKmer -c -1\n\n>`--fastaFileDir` or `-f`: The fasta file of prokaryotic genome sequences, **one genome per file**.<br>  \n>`--kmerFileDir` or `-d`: The path of prokaryotic *K*-mer file.<br>  \n>`--kmerName` or `-n`: The name of prokaryotic *K*-mer file.<br>  \n>`--coreNum` or `-c`: The number of cores used in *k*-mer calculation. -1 represents the use of all cores.<br>  \n\n#### *K-mer file of 60,105 prokaryotic genomes is saved in current folder and named `hostKmer_60105_kmer4.tar.gz`<br>\n#### *Users can directly use the *K*-mer file to run the step 2 after decompression.<br>\n#### *The taxonomy information of the 60,105 genomes is saved in /interactionTable/MARGE_PAIR_TAX.xls<br><br>  \n\n## Step 2: predict the infection relationship between the virus and the host\n\n    python3 PHP.py --virusFastaFileDir ./exampleVirusGenome  --outFileDir ./exampleOutput  --bacteriaKmerDir ./exampleOutput  --bacteriaKmerName HostKmer\n\nOr use the simplify command\n\n    python3 PHP.py -v ./exampleVirusGenome  -o ./exampleOutput  -d ./exampleOutput  -n HostKmer\n\n>`--virusFastaFileDir` or `-v`: The fasta file of query virus sequences, **one virus genome per file**.<br>  \n>`--outFileDir` or `-o`: The path of temp files and result files.<br>  \n>`--bacteriaKmerDir` or `-d`: The path of prokaryotic *K*-mer file.<br>  \n>`--bacteriaKmerName` or `-n`: The name of prokaryotic *K*-mer file.<br>  \n\n\nInterpretation of Result\n===========\nAfter running the prediction program, you will see the output files Prediction_Maxhost and Prediction_Allhost in the output folder.<br>  \n>In document `Prediction_Maxhost.tsv`, The first column is the input virus\uff0cThe third column is the highest score host and the second is the score of this host. <br>  \n>In document `Prediction_Allhost.csv`, query viruses and scores for all prokaryotic genomes are given. <br>  \n\nThe corresponding accuracy of different scoring thresholds is as follows.<br>  \n>![image](https://github.com/congyulu-bioinfo/PHP/blob/master/table1.png)<br>  \n>![image](https://github.com/congyulu-bioinfo/PHP/blob/master/table2.png)<br>  \n\nUsers use their own data to customize the model\n===========\nUsers can use their own data to train customized models, `/exampleTrainingData/` provides sample data, each folder containing one pair of viruses and host genomes in exampleTrainingData. <br>\nThe virus needs to be saved in the `/phage/` folder, and the host needs to be saved in the `/host/` folder.<br>\nThen run the following command to automatically train to get the model\n\n    python3 PHP_UserTrain.py --trainDataDir ./exampleTrainingData --outFileDir ./exampleOutput --modelName UserModel.m\n\n>`--trainDataDir` The training data folder, in which each pair of training data is saved in its own folder<br>  \n>`--outFileDir` The path to save the trained model<br>  \n>`--modelName` The name of the trained model<br>  \n\nUsers need to rename and replace the original PHP model to use the customized model<br>  <br>  <br>  \n\n\n\n\npredict short virus query contig\n-----------\nIf your input sequences contain sequences shorter than 12500 bp, \nthe program will automatically identify these short segments and use the corresponding model to predict.  \n>if 12500bp< length\uff0cThe sequence will be predicted using a full length model;<br>  \n>if 7500bp < length <= 12500bp, The sequence will be predicted using a 10000bp model;<br>  \n>if 4000bp < length <= 7500bp, The sequence will be predicted using a 5000bp model;<br>  \n>if 2000 < length <= 4000bp, The sequence will be predicted using a 3000bp model;<br>  \n>if length<=2000bp, The sequence will be predicted using a 1000bp model;<br>  \n\n\n\n\n\n\n"
}